receivers:
  windowseventlog:
    channel: application
    start_at: beginning

processors:
  sllogformat:
    send_batch_size: 10000
    timeout: 10s
    profiles:
    - service_group: lit:default:ze_deployment_name # windows event log
      source: body:computer:zid_host
      log_type: body:provider.name:zid_log:rmprefix=Microsoft-Windows-:alphanum:lc
      labels:
      - body:channel:win_channel
      - body:keywords:win_keywords
      message: body:message|event_data|keywords
      format: event
    - service_group: lit:default:ze_deployment_name # docker logs
      source: rattr:host.name:zid_host
      log_type: attr:container_id:zid_log
      labels:
      - rattr:os.type
      - attr:log.file.path:zid_path
      message: body
      format: message

exporters:
  logging:
    verbosity: detailed

service:
  pipelines:
    logs:
      receivers: [windowseventlog]
      processors: [sllogformat]
      exporters: [logging]
